##⇘⇘基本说明：
##这是附属设置文件，是配置组的集合，通用区已有的参数会被激活的配置组覆盖
##需要主设置文件 "mpv.conf" 中的 --include 参数指定后本文件才生效
##[xxx] 用于定义一组配置的头部标签，注释某组参数不能只注释头部
##详细了解配置组与通用参数的混合用法请读手册 [02]
##关于被删去的“内置配置组”与“传统配置组”部分，查看 https://github.com/hooke007/MPV_lazy/discussions/42

 ##############
 # 常规配置组 #
 ##############
##⇘⇘常规配置没有自动触发条件（内置配置组也全为常规配置）
##需要主设置文件中使用 --profile=<profile1,profile2,...> 或多行 --profile=<xxx> 参数激活数个配置

[DeBand+]
 profile-desc        = 自定义去色带方案
 deband              = yes
 deband-iterations   = 3    # <1-16> 去色带执行次数，越高强度但也越费时费力，数值>4实际无效（默认1）
 deband-threshold    = 48   # <0-4096> 滤波器的截止阈值，更高的数字会增加强度，但会逐渐减少图像细节（默认32）
 deband-range        = 12   # <1-64> 初始半径，越大的值去色带越强且性能占用越高；值越小越平滑（默认值16）。如果增大 --deband-iterations，需减小此值来进行补偿
 deband-grain        = 24   # <0-4096> [如果使用以下两个静态降噪着色器，将此设置为0] 添加额外动态噪点，有助于掩盖剩余的量化伪影（默认48）
#glsl-shaders-append = "~~/shaders/noise_static_chroma.glsl"
#glsl-shaders-append = "~~/shaders/noise_static_luma.glsl"



 ##############
 # 条件配置组 #
 ##############
##⇘⇘条件触发配置，根据给定条件激发特定参数。简易格式见示例
##仅注释掉 --profile-cond 和 --profile-restore 即可将条件配置变为常规配置，常规配置的使用方法为通用区 --profile=<value>

##⇘⇘条件配置的格式示例
##[FS-loop]                              # 配置名称，自定义
##profile-desc    = 全屏时循环播放当前文件 # 配置的描述，不属于参数，随意写
##profile-cond    = fullscreen           # 触发该配置的条件。可用的属性列表 https://mpv.io/manual/master/#property-list
##profile-restore = copy                 # 此参数一般用于回归触发前的通用参数（关闭此项将保留）
##...                                    # 然后写该条件下触发的参数
##...

##⇘⇘备选的HDR转SDR方案，若你的显卡不支持 --hdr-compute-peak 应启用这个方案且禁用 [H2S-DTM]
##直接注释与取消注释 --profile-cond 而非一组全部参数即可快速替换为 [H2S-STM]
[H2S-STM]
 profile-desc                     = HDR转SDR（静态色调映射）
#profile-cond                     = p["video-params/sig-peak"]>1
 profile-restore                  = copy
#blend-subtitles                  = video      # 问题状态（静态映射不受影响） https://github.com/mpv-player/mpv/issues/6368
 target-peak                      = 100        # <10-10000> 值越低，画面整体越亮。默认auto即203（不要用作通用参数，因为会影响sdr片源的正常输出亮度）
 hdr-compute-peak                 = no         # 当yes时提供了基于场景的动态色调映射默认auto（完整支持该特性需要显卡opengl版本≥4.3）
 tone-mapping                     = hable      # <auto默认|clip|mobius|reinhard|hable|bt.2390|gamma|linear> 色调映射算法
#tone-mapping-param               = default    # 上项的小参。default根据算法的使用不同初始值，对部分算法无效
                                               # clip=1.0; mobius=0.3; reinhard=0.5; gamma=1.8; linear=1.0
 tone-mapping-mode                = rgb        # <auto默认|rgb|max|hybrid> 色调映射模式
 gamut-mapping-mode               = desaturate # <auto默认|clip|warn|desaturate> 完成色调映射后的色域裁剪方式
 tone-mapping-max-boost           = 1.0        # <1.0-10.0> 过曝指数，默认1.0


## 其它可选的改良方案 https://github.com/hooke007/MPV_lazy/discussions/25
[H2S-DTM]
 profile-desc                     = HDR转SDR（动态色调映射-基础版）
 profile-cond                     = p["video-params/sig-peak"]>1
 profile-restore                  = copy
 blend-subtitles                  = no
#target-peak                      = auto
 hdr-compute-peak                 = yes
 tone-mapping                     = bt.2390
#tone-mapping-param               = default
 tone-mapping-mode                = hybrid
 gamut-mapping-mode               = clip
 tone-mapping-max-boost           = 1.5
 hdr-peak-decay-rate              = 150        # [须 --hdr-compute-peak=yes ] <1.0-1000.0> 亮度峰值检测算法的衰减率，默认100.0
 hdr-scene-threshold-low          = 4          # [须 --hdr-compute-peak=yes ] <0.0-100.0> 场景变化亮度的下限阈值，默认5.5
 hdr-scene-threshold-high         = 16         # [须 --hdr-compute-peak=yes ] <0.0-100.0> 场景变化亮度的上限阈值，默认10.0


##⇘⇘文件名匹配的示例写法：根据文件名中的特定字符触发配置
##字符 "-" 需要使用LUA的转义符 "%"
[VCB-Studio]
 profile-desc     = 真空断路器
 profile-cond     = filename:match("VCB%-Studio")~=nil
 profile-restore  = copy
 term-playing-msg = "LittlePox : SAYA is a lolicon !!!"


[DVD-Anime]
#profile-desc    = 2D低清源增强
#profile-cond    = height<=576
#profile-restore = copy
#glsl-shaders    = "~~/shaders/Anime4K_Upscale_CNN_L_x2_Denoise.glsl;~~/shaders/Anime4K_Deblur_DoG.glsl;~~/shaders/Anime4K_DarkLines_HQ.glsl;~~/shaders/Anime4K_ThinLines_HQ.glsl;~~/shaders/Anime4K_Upscale_CNN_M_x2_Deblur.glsl"


[rot-fix]
 profile-desc    = 修复旋转输出的色度破坏 # 问题状态 https://github.com/mpv-player/mpv/issues/8223
 profile-cond    = p["video-params/rotate"]==90 or p["video-params/rotate"]==270
 profile-restore = copy
 hwdec           = no


